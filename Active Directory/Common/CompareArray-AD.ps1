$Users = @(
    4037,
    2708,
    0722,
    2051,
    2706,
    2707,
    2705,
    2710,
    2712,
    2713,
    2709,
    2711,
    2891,
    1923,
    1917,
    1918,
    1920,
    0136,
    1926,
    1976,
    1978,
    1922,
    1910,
    1915,
    1921,
    1980,
    1907,
    1997,
    0736,
    1911,
    1933,
    1909,
    1908,
    7767,
    7768,
    7639,
    7772,
    7771,
    7775,
    7773,
    7774,
    7764,
    7297,
    7525,
    7763,
    7766,
    8510,
    8352,
    8303,
    8340,
    8350,
    8346,
    8345,
    8339,
    8359,
    8353,
    8360,
    8355,
    8362,
    8354,
    8366,
    8349,
    8368,
    8348,
    8343,
    8373,
    8347,
    8372,
    8371,
    8370,
    8351,
    8365,
    8364,
    8367,
    8369,
    8356,
    8357,
    8358,
    4705,
    4707,
    2926,
    1820,
    1821,
    4719,
    3832,
    2905
)

$UserArray = @() # Create an empty array to store user objects

Foreach ($User in $Users) {
    $UserInfo = Get-ADUser -Identity $User -Properties SamAccountName, DisplayName
    $UserObject = [PSCustomObject]@{
        SamAccountName = $UserInfo.SamAccountName
        DisplayName = $UserInfo.DisplayName
        Password = ($UserInfo.DisplayName.Substring(5, 3) + $UserInfo.DisplayName.Substring(8, 3).ToLower() + $UserInfo.SamAccountName)
    }
    $UserArray += $UserObject # Add the user object to the array
}

$UserArray # Output the array
$UserArray | Out-GridView
